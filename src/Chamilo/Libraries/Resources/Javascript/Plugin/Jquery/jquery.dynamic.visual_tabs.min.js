(function(a){a.fn.extend({dynamic_tabs:function(e){var j={tabsPerPage:0,nextButton:"",prevButton:"",follow:false,cycle:false};var n=a.extend(j,e);var p=this,g=false,s,r,l,f,i,o,m,d=null,k=a(window).height(),x=a(window).width(),t=0;function u(){p.lis=a("li",p);f=0,s=0,o=0,r=0,m=new Array(),i=new Array(),selectedTabWidths=new Array();l=a(p).width();$li=a('<li><a href="#">'+n.nextButton+"</a></li>").click(function(){h("next");return false}).addClass("menu-tabs-next");p.lis.eq(a(p.lis).length-1).after($li);r=$li.width();$li=a('<li><a href="#">'+n.prevButton+"</a></li>").click(function(){h("prev");return false}).addClass("menu-tabs-prev");p.lis.eq(0).before($li);r+=$li.width();r+=70;p.lis.each(function(C){var D=a(this);i[C]=D.width();selectedTabWidths[C]=D.width();f+=D.width();if(a(D).hasClass("ui-tabs-selected")){t=C}});if(f>l){var y=0,z=0,B=0;for(var A=0;A<i.length;A++){if(z==0||selectedTabWidths[A]-i[A]>B){B=(selectedTabWidths[A]-i[A])}if(m[y]==null){m[y]={start:A}}else{if((A>0&&(A%n.tabsPerPage)==0)||(i[A]+z+r+12)>l){if((z+B)>o){o=(z+B)}y++;m[y]={start:A};z=0}}m[y].end=A+1;z+=i[A];if(A==t){s=y}}if((z+B)>o){o=(z+B)}p.lis.hide().slice(m[s].start,m[s].end).show();if(s==(m.length-1)&&!n.cycle){b("next")}if(s==0&&!n.cycle){b("prev")}buttonPadding=l-o-r-8;g=true}else{v()}a(window).bind("resize",w)}function h(z){s=s+(z=="prev"?-1:1);if(z=="prev"&&s<0&&n.cycle){s=m.length-1}else{if((z=="prev"&&s<0)||(z=="next"&&s>=m.length)){s=0}}var A=m[s].start;var y=m[s].end;p.lis.hide().slice(m[s].start,m[s].end).show();if(z=="prev"){q("next");if(n.follow&&(t<A||t>(y-1))){p.select(y-1)}if(!n.cycle&&A<=0){b("prev")}}else{q("prev");if(n.follow&&(t<A||t>(y-1))){p.select(A)}if(!n.cycle&&y>=a(p.lis).length){b("next")}}}function b(y){a(".menu-tabs-"+y,p).hide()}function q(y){a(".menu-tabs-"+y,p).show()}function w(){if(d){clearTimeout(d)}if(k!=a(window).height()||x!=a(window).width()){d=setTimeout(c,100)}}function c(){k=a(window).height();x=a(window).width();v();u()}function v(){a(".menu-tabs-next",p).remove();a(".menu-tabs-prev",p).remove();p.lis.show();g=false;a(window).unbind("resize",w)}u()}})})(jQuery);