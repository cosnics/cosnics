Dropzone.autoDiscover=false;var dropzoneCallbacks={};(function(a){a.fn.extend({fileUpload:function(g){var c=getPath("WEB_PATH")+"index.php";var j={name:"file",maxFilesize:100,thumbnailWidth:200,thumbnailHeight:150,maxFiles:null,uploadUrl:c+"?application=Chamilo\\Libraries\\Ajax&go=UploadTemporaryFile",successCallbackFunction:null,sendingCallbackFunction:null,removedfileCallbackFunction:null,acceptCallbackFunction:null,initCallbackFunction:null,autoProcessQueue:true,acceptedFiles:""};var r=a.extend(j,g);var n=a(this),t,b,f;var s={container:n,dropzone:t,settings:r};function l(w){var v=w.split(".");return v.pop()}function k(z){var y=z.split(".");var x=y.pop();var w=dropzoneCallbacks;for(var v=0;v<y.length;v++){w=w[y[v]]}return w}function d(y,A){var w=a(y.previewElement);var x=r.successCallbackFunction;a(".progress",w).hide();a(" button.cancel",w).hide();if(x!=null){var v=k(x);var z=l(x);v[z](s,y,A)}}function i(){return t.files.length}function m(y,x,z){var w=r.sendingCallbackFunction;z.append("filePropertyName",r.name);if(r.sendingCallbackFunction!=null){var v=k(w);var A=l(w);v[A](s,y,x,z)}}function u(w,z){var x=r.removedfileCallbackFunction;if(x!=null){var v=k(x);var y=l(x);v[y](s,w,z)}if(r.maxFiles!=null&&i()<r.maxFiles){a(".panel",n).show()}}function o(x,w){var y=r.acceptCallbackFunction;if(r.maxFiles!=null&&i()>=r.maxFiles){a(".panel",n).hide()}if(y!=null){var v=k(y);var z=l(y);v[z](s,x,w)}else{w()}}function q(x,y){var v=a(x.previewElement);var w=a(".preview",v);a(".file-upload-no-preview",w).hide()}function e(){b=a("#"+r.name+"-template");b.removeAttr("id");f=b.parent().html();b.remove()}function h(){a("#"+r.name+"-upload-input",n).hide()}function p(){h();e();t=new Dropzone("#"+r.name+"-upload",{paramName:r.name,maxFiles:r.maxFiles,previewTemplate:f,previewsContainer:"#"+r.name+"-previews",clickable:"#"+r.name+"-upload .panel-body",maxFilesize:r.maxFilesize,filesizeBase:1024,thumbnailWidth:r.thumbnailWidth,thumbnailHeight:r.thumbnailHeight,url:r.uploadUrl,parallelUploads:2,autoProcessQueue:r.autoProcessQueue===true||r.autoProcessQueue==="true",acceptedFiles:r.acceptedFiles,init:function(){this.on("success",d);this.on("sending",m);this.on("removedfile",u);this.on("thumbnail",q)},accept:o});s.dropzone=t;var w=r.initCallbackFunction;if(w!=null){var v=k(w);var x=l(w);v[x](s)}}return this.each(p)}})})(jQuery);