{"remainingRequest":"D:\\Sites\\branch\\node_modules\\babel-loader\\lib\\index.js!D:\\Sites\\branch\\node_modules\\ts-loader\\index.js??ref--13-2!D:\\Sites\\branch\\src\\Chamilo\\Libraries\\VuePlugins\\src\\Plugins\\ScoreRubric\\Domain\\Rubric.ts","dependencies":[{"path":"D:\\Sites\\branch\\src\\Chamilo\\Libraries\\VuePlugins\\src\\Plugins\\ScoreRubric\\Domain\\Rubric.ts","mtime":1574763316000},{"path":"D:\\Sites\\branch\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Sites\\branch\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\Sites\\branch\\node_modules\\ts-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5mcm9tIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5yZWR1Y2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5kYXRlLnRvLWpzb24iOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIudXJsLnRvLWpzb24iOwppbXBvcnQgX3RvQ29uc3VtYWJsZUFycmF5IGZyb20gIkQ6XFxTaXRlc1xcYnJhbmNoXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheSI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiRDpcXFNpdGVzXFxicmFuY2hcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICJEOlxcU2l0ZXNcXGJyYW5jaFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4gZnJvbSAiRDpcXFNpdGVzXFxicmFuY2hcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iOwppbXBvcnQgX2dldFByb3RvdHlwZU9mIGZyb20gIkQ6XFxTaXRlc1xcYnJhbmNoXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9nZXRQcm90b3R5cGVPZiI7CmltcG9ydCBfZ2V0IGZyb20gIkQ6XFxTaXRlc1xcYnJhbmNoXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9nZXQiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIkQ6XFxTaXRlc1xcYnJhbmNoXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9pbmhlcml0cyI7CmltcG9ydCBDbHVzdGVyIGZyb20gIkAvUGx1Z2lucy9TY29yZVJ1YnJpYy9Eb21haW4vQ2x1c3RlciI7CmltcG9ydCBMZXZlbCBmcm9tICJAL1BsdWdpbnMvU2NvcmVSdWJyaWMvRG9tYWluL0xldmVsIjsKaW1wb3J0IENob2ljZSBmcm9tICJAL1BsdWdpbnMvU2NvcmVSdWJyaWMvRG9tYWluL0Nob2ljZSI7CmltcG9ydCBDcml0ZXJpdW0gZnJvbSAiQC9QbHVnaW5zL1Njb3JlUnVicmljL0RvbWFpbi9Dcml0ZXJpdW0iOwppbXBvcnQgQ29udGFpbmVyIGZyb20gIkAvUGx1Z2lucy9TY29yZVJ1YnJpYy9Eb21haW4vQ29udGFpbmVyIjsKZXhwb3J0IGZ1bmN0aW9uIGlzRWxlbWVudChvYmplY3QpIHsKICByZXR1cm4gJ3BhcmVudCcgaW4gb2JqZWN0ICYmICd0aXRsZScgaW4gb2JqZWN0Owp9CmV4cG9ydCBmdW5jdGlvbiBpc0NvbnRhaW5lcihvYmplY3QpIHsKICByZXR1cm4gJ2NoaWxkcmVuJyBpbiBvYmplY3QgJiYgaXNFbGVtZW50KG9iamVjdCk7Cn0KCnZhciBSdWJyaWMgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uIChfQ29udGFpbmVyKSB7CiAgX2luaGVyaXRzKFJ1YnJpYywgX0NvbnRhaW5lcik7CgogIGZ1bmN0aW9uIFJ1YnJpYygpIHsKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUnVicmljKTsKCiAgICBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9nZXRQcm90b3R5cGVPZihSdWJyaWMpLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpOwogICAgX3RoaXMudXNlU2NvcmVzID0gdHJ1ZTsKICAgIF90aGlzLmxldmVscyA9IFtdOwogICAgX3RoaXMuY2hvaWNlcyA9IG5ldyBNYXAoKTsKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhSdWJyaWMsIFt7CiAgICBrZXk6ICJhZGRDbHVzdGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRDbHVzdGVyKGNsdXN0ZXIpIHsKICAgICAgdGhpcy5hZGRDaGlsZChjbHVzdGVyKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW1vdmVDbHVzdGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVDbHVzdGVyKGNsdXN0ZXIpIHsKICAgICAgdGhpcy5yZW1vdmVDaGlsZChjbHVzdGVyKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJhZGRDaGlsZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYWRkQ2hpbGQoZWxlbWVudCkgewogICAgICBfZ2V0KF9nZXRQcm90b3R5cGVPZihSdWJyaWMucHJvdG90eXBlKSwgImFkZENoaWxkIiwgdGhpcykuY2FsbCh0aGlzLCBlbGVtZW50KTsKCiAgICAgIHRoaXMubm90aWZ5QWRkQ2hpbGQoZWxlbWVudCk7CiAgICB9CiAgfSwgewogICAga2V5OiAibm90aWZ5QWRkQ2hpbGQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG5vdGlmeUFkZENoaWxkKGVsZW1lbnQpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIENyaXRlcml1bSkgewogICAgICAgIHRoaXMub25Dcml0ZXJpdW1BZGRlZChlbGVtZW50KTsKICAgICAgfSBlbHNlIGlmIChlbGVtZW50IGluc3RhbmNlb2YgQ29udGFpbmVyKSB7CiAgICAgICAgdmFyIGFkZGVkQ3JpdGVyaWEgPSB0aGlzLmdldEFsbENyaXRlcmlhKGVsZW1lbnQpOwogICAgICAgIGFkZGVkQ3JpdGVyaWEuZm9yRWFjaChmdW5jdGlvbiAoY3JpdGVyaXVtKSB7CiAgICAgICAgICBfdGhpczIubGV2ZWxzLmZvckVhY2goZnVuY3Rpb24gKGxldmVsKSB7CiAgICAgICAgICAgIHZhciBjaG9pY2UgPSBfdGhpczIuZmluZENob2ljZShjcml0ZXJpdW0sIGxldmVsKTsKCiAgICAgICAgICAgIGlmICghY2hvaWNlKSBjaG9pY2UgPSBuZXcgQ2hvaWNlKGZhbHNlLCAiIik7CgogICAgICAgICAgICBfdGhpczIuYWRkQ2hvaWNlKGNob2ljZSwgY3JpdGVyaXVtLmlkLCBsZXZlbC5pZCk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSAvL25vIG1vcmUgYnViYmxpbmcKCiAgICB9CiAgfSwgewogICAga2V5OiAib25Dcml0ZXJpdW1BZGRlZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25Dcml0ZXJpdW1BZGRlZChjcml0ZXJpdW0pIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICB0aGlzLmxldmVscy5mb3JFYWNoKGZ1bmN0aW9uIChsZXZlbCkgewogICAgICAgIC8vY2hvaWNlIGFscmVhZHkgZXhpc3RzIGZvciBjcml0ZXJpdW0/IENvdWxkIGJlIHRocm91Z2gganNvbiBib290c3RyYXBwaW5nLgogICAgICAgIHZhciBjaG9pY2UgPSBfdGhpczMuZmluZENob2ljZShjcml0ZXJpdW0sIGxldmVsKTsKCiAgICAgICAgaWYgKCFjaG9pY2UpIGNob2ljZSA9IG5ldyBDaG9pY2UoZmFsc2UsICIiKTsKCiAgICAgICAgX3RoaXMzLmFkZENob2ljZShjaG9pY2UsIGNyaXRlcml1bS5pZCwgbGV2ZWwuaWQpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJub3RpZnlSZW1vdmVDaGlsZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbm90aWZ5UmVtb3ZlQ2hpbGQoY29udGFpbmVyLCBlbGVtZW50KSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgdmFyIGNyaXRlcmlhVG9CZVJlbW92ZWQgPSB0aGlzLmdldEFsbENyaXRlcmlhKGNvbnRhaW5lcik7CiAgICAgIGNyaXRlcmlhVG9CZVJlbW92ZWQuZm9yRWFjaChmdW5jdGlvbiAoY3JpdGVyaXVtKSB7CiAgICAgICAgcmV0dXJuIF90aGlzNC5yZW1vdmVDaG9pY2VzQnlDcml0ZXJpdW0oY3JpdGVyaXVtKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAidG9KU09OIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB0b0pTT04oKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgdXNlU2NvcmVzOiB0aGlzLnVzZVNjb3JlcywKICAgICAgICB0aXRsZTogdGhpcy50aXRsZSwKICAgICAgICBsZXZlbHM6IHRoaXMubGV2ZWxzLAogICAgICAgIGNsdXN0ZXJzOiB0aGlzLl9jaGlsZHJlbi5tYXAoZnVuY3Rpb24gKGNsdXN0ZXIpIHsKICAgICAgICAgIHJldHVybiBjbHVzdGVyLnRvSlNPTigpOwogICAgICAgIH0pLAogICAgICAgIGNob2ljZXM6IHRoaXMuZ2V0Q2hvaWNlc0pTT04oKQogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogImdldENob2ljZXNKU09OIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDaG9pY2VzSlNPTigpIHsKICAgICAgdmFyIGNob2ljZXNBcnJheSA9IFtdOwogICAgICB0aGlzLmNob2ljZXMuZm9yRWFjaChmdW5jdGlvbiAobGV2ZWxNYXAsIGNyaXRlcml1bUlkKSB7CiAgICAgICAgbGV2ZWxNYXAuZm9yRWFjaChmdW5jdGlvbiAoY2hvaWNlLCBsZXZlbElkKSB7CiAgICAgICAgICBjaG9pY2VzQXJyYXkucHVzaCh7CiAgICAgICAgICAgICJjcml0ZXJpdW1JZCI6IGNyaXRlcml1bUlkLAogICAgICAgICAgICAibGV2ZWxJZCI6IGxldmVsSWQsCiAgICAgICAgICAgICJjaG9pY2UiOiBjaG9pY2UudG9KU09OKCkKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KTsKICAgICAgcmV0dXJuIGNob2ljZXNBcnJheTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJhZGRDaG9pY2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZENob2ljZShjaG9pY2UsIGNyaXRlcml1bUlkLCBsZXZlbElkKSB7CiAgICAgIHZhciBjcml0ZXJpdW1DaG9pY2VzID0gdGhpcy5jaG9pY2VzLmdldChjcml0ZXJpdW1JZCk7CgogICAgICBpZiAoY3JpdGVyaXVtQ2hvaWNlcyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgY3JpdGVyaXVtQ2hvaWNlcyA9IG5ldyBNYXAoKTsKICAgICAgICB0aGlzLmNob2ljZXMuc2V0KGNyaXRlcml1bUlkLCBjcml0ZXJpdW1DaG9pY2VzKTsKICAgICAgfQoKICAgICAgY3JpdGVyaXVtQ2hvaWNlcy5zZXQobGV2ZWxJZCwgY2hvaWNlKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW1vdmVDaG9pY2VzQnlDcml0ZXJpdW0iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZUNob2ljZXNCeUNyaXRlcml1bShjcml0ZXJpdW0pIHsKICAgICAgdGhpcy5jaG9pY2VzLmRlbGV0ZShjcml0ZXJpdW0uaWQpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbW92ZUNob2ljZXNCeUxldmVsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVDaG9pY2VzQnlMZXZlbChsZXZlbCkgewogICAgICBBcnJheS5mcm9tKHRoaXMuY2hvaWNlcy52YWx1ZXMoKSkuZm9yRWFjaChmdW5jdGlvbiAobGV2ZWxDaG9pY2VzKSB7CiAgICAgICAgcmV0dXJuIGxldmVsQ2hvaWNlcy5kZWxldGUobGV2ZWwuaWQpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJmaW5kQ2hvaWNlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmaW5kQ2hvaWNlKGNyaXRlcml1bSwgbGV2ZWwpIHsKICAgICAgdmFyIGNyaXRlcml1bUNob2ljZXMgPSB0aGlzLmNob2ljZXMuZ2V0KGNyaXRlcml1bS5pZCk7CgogICAgICBpZiAoY3JpdGVyaXVtQ2hvaWNlcyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgfQoKICAgICAgcmV0dXJuIGNyaXRlcml1bUNob2ljZXMuZ2V0KGxldmVsLmlkKTsKICAgIH0KICAgIC8qKg0KICAgICAqIEludmFyaWFudDogdG8gdGhlIG91dHNpZGUgd29ybGQgYSBjaG9pY2UgaXMgYWx3YXlzIGF2YWlsYWJsZSBmb3IgYSBjcml0ZXJpdW0gYW5kIGxldmVsIG9mIHRoZSBydWJyaWMuDQogICAgICogQHBhcmFtIGNyaXRlcml1bQ0KICAgICAqIEBwYXJhbSBsZXZlbA0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRDaG9pY2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldENob2ljZShjcml0ZXJpdW0sIGxldmVsKSB7CiAgICAgIHZhciBjaG9pY2UgPSB0aGlzLmZpbmRDaG9pY2UoY3JpdGVyaXVtLCBsZXZlbCk7CgogICAgICBpZiAoIWNob2ljZSkgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiTm8gY2hvaWNlIGZvdW5kIGZvciBjcml0ZXJpYTogIi5jb25jYXQoY3JpdGVyaXVtLCAiIGFuZCBsZXZlbDogIikuY29uY2F0KGxldmVsKSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBjaG9pY2U7CiAgICB9CiAgfSwgewogICAga2V5OiAiYWRkTGV2ZWwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZExldmVsKGxldmVsKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgdGhpcy5sZXZlbHMucHVzaChsZXZlbCk7CiAgICAgIHRoaXMuZ2V0QWxsQ3JpdGVyaWEoKS5mb3JFYWNoKGZ1bmN0aW9uIChjcml0ZXJpdW0pIHsKICAgICAgICBfdGhpczUuYWRkQ2hvaWNlKG5ldyBDaG9pY2UoZmFsc2UsICIiKSwgY3JpdGVyaXVtLmlkLCBsZXZlbC5pZCk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbW92ZUxldmVsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVMZXZlbChsZXZlbCkgewogICAgICB2YXIgaW5kZXggPSB0aGlzLmxldmVscy5pbmRleE9mKGxldmVsKTsKICAgICAgdGhpcy5sZXZlbHMuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgdGhpcy5yZW1vdmVDaG9pY2VzQnlMZXZlbChsZXZlbCk7CiAgICB9CiAgfSwgewogICAga2V5OiAibW92ZUxldmVsRG93biIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbW92ZUxldmVsRG93bihsZXZlbCkgewogICAgICB0aGlzLm1vdmVJdGVtSW5BcnJheSh0aGlzLmxldmVscywgdGhpcy5sZXZlbHMuaW5kZXhPZihsZXZlbCksIHRoaXMubGV2ZWxzLmluZGV4T2YobGV2ZWwpICsgMSk7CiAgICB9CiAgfSwgewogICAga2V5OiAibW92ZUxldmVsVXAiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG1vdmVMZXZlbFVwKGxldmVsKSB7CiAgICAgIHRoaXMubW92ZUl0ZW1JbkFycmF5KHRoaXMubGV2ZWxzLCB0aGlzLmxldmVscy5pbmRleE9mKGxldmVsKSwgdGhpcy5sZXZlbHMuaW5kZXhPZihsZXZlbCkgLSAxKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJtb3ZlSXRlbUluQXJyYXkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG1vdmVJdGVtSW5BcnJheShhcnJheSwgZnJvbSwgdG8pIHsKICAgICAgaWYgKHRvID49IGFycmF5Lmxlbmd0aCB8fCBmcm9tID49IGFycmF5Lmxlbmd0aCkgcmV0dXJuOwogICAgICBpZiAodG8gPCAwIHx8IGZyb20gPCAwKSByZXR1cm47CiAgICAgIGFycmF5LnNwbGljZSh0bywgMCwgYXJyYXkuc3BsaWNlKGZyb20sIDEpWzBdKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRDaG9pY2VTY29yZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q2hvaWNlU2NvcmUoY3JpdGVyaXVtLCBsZXZlbCkgewogICAgICB2YXIgY2hvaWNlID0gdGhpcy5nZXRDaG9pY2UoY3JpdGVyaXVtLCBsZXZlbCk7CiAgICAgIGlmIChjaG9pY2UuaGFzRml4ZWRTY29yZSkgcmV0dXJuIGNob2ljZS5maXhlZFNjb3JlOwogICAgICByZXR1cm4gTWF0aC5yb3VuZChjcml0ZXJpdW0ud2VpZ2h0ICogbGV2ZWwuc2NvcmUpIC8gMTAwOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFNjb3JlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRTY29yZSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuLnJlZHVjZShmdW5jdGlvbiAoYWNjdW11bGF0b3IsIGN1cnJlbnRDb250YWluZXIpIHsKICAgICAgICByZXR1cm4gYWNjdW11bGF0b3IgKyBjdXJyZW50Q29udGFpbmVyLmdldFNjb3JlKCk7CiAgICAgIH0sIDApOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEFsbENyaXRlcmlhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRBbGxDcml0ZXJpYSgpIHsKICAgICAgdmFyIGNvbnRhaW5lciA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogdGhpczsKICAgICAgdmFyIGNyaXRlcmlhID0gW107CiAgICAgIHRoaXMuZ2V0Q3JpdGVyaWFSZWN1cnNpdmUoY29udGFpbmVyLCBjcml0ZXJpYSk7CiAgICAgIHJldHVybiBjcml0ZXJpYTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRDcml0ZXJpYVJlY3Vyc2l2ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q3JpdGVyaWFSZWN1cnNpdmUoY29udGFpbmVyLCBjcml0ZXJpYSkgewogICAgICB2YXIgX3RoaXM2ID0gdGhpczsKCiAgICAgIGNvbnRhaW5lci5jaGlsZHJlbi5maWx0ZXIoZnVuY3Rpb24gKGNoaWxkKSB7CiAgICAgICAgcmV0dXJuIGNoaWxkIGluc3RhbmNlb2YgQ3JpdGVyaXVtOwogICAgICB9KS5mb3JFYWNoKGZ1bmN0aW9uIChjcml0ZXJpdW0pIHsKICAgICAgICByZXR1cm4gY3JpdGVyaWEucHVzaChjcml0ZXJpdW0pOwogICAgICB9KTsKICAgICAgY29udGFpbmVyLmNoaWxkcmVuLmZpbHRlcihmdW5jdGlvbiAoY2hpbGQpIHsKICAgICAgICByZXR1cm4gaXNDb250YWluZXIoY2hpbGQpOwogICAgICB9KS5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZENvbnRhaW5lcikgewogICAgICAgIHJldHVybiBfdGhpczYuZ2V0Q3JpdGVyaWFSZWN1cnNpdmUoY2hpbGRDb250YWluZXIsIGNyaXRlcmlhKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY2x1c3RlcnMiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLmNoaWxkcmVuOyAvL2ludmFyaWFudCBnYXJkZWQgYXQgYWRkQ2hpbGQKICAgIH0KICB9XSwgW3sKICAgIGtleTogImZyb21KU09OIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmcm9tSlNPTihydWJyaWMpIHsKICAgICAgdmFyIF9uZXdSdWJyaWMkbGV2ZWxzOwoKICAgICAgdmFyIHJ1YnJpY09iamVjdDsKCiAgICAgIGlmICh0eXBlb2YgcnVicmljID09PSAnc3RyaW5nJykgewogICAgICAgIHJ1YnJpY09iamVjdCA9IEpTT04ucGFyc2UocnVicmljKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBydWJyaWNPYmplY3QgPSBydWJyaWM7CiAgICAgIH0KCiAgICAgIHZhciBuZXdSdWJyaWMgPSBuZXcgUnVicmljKHJ1YnJpY09iamVjdC50aXRsZSk7CgogICAgICAoX25ld1J1YnJpYyRsZXZlbHMgPSBuZXdSdWJyaWMubGV2ZWxzKS5wdXNoLmFwcGx5KF9uZXdSdWJyaWMkbGV2ZWxzLCBfdG9Db25zdW1hYmxlQXJyYXkocnVicmljT2JqZWN0LmxldmVscy5tYXAoZnVuY3Rpb24gKGxldmVsKSB7CiAgICAgICAgcmV0dXJuIExldmVsLmZyb21KU09OKGxldmVsKTsKICAgICAgfSkpKTsKCiAgICAgIHJ1YnJpY09iamVjdC5jaG9pY2VzLmZvckVhY2goZnVuY3Rpb24gKHJ1YnJpY0Nob2ljZUpzb25PYmplY3QpIHsKICAgICAgICBuZXdSdWJyaWMuYWRkQ2hvaWNlKENob2ljZS5mcm9tSlNPTihydWJyaWNDaG9pY2VKc29uT2JqZWN0LmNob2ljZSksIHJ1YnJpY0Nob2ljZUpzb25PYmplY3QuY3JpdGVyaXVtSWQsIHJ1YnJpY0Nob2ljZUpzb25PYmplY3QubGV2ZWxJZCk7CiAgICAgIH0pOwogICAgICBydWJyaWNPYmplY3QuY2x1c3RlcnMubWFwKGZ1bmN0aW9uIChjbHVzdGVySnNvbk9iamVjdCkgewogICAgICAgIHJldHVybiBDbHVzdGVyLmZyb21KU09OKGNsdXN0ZXJKc29uT2JqZWN0KTsKICAgICAgfSkuZm9yRWFjaChmdW5jdGlvbiAoY2x1c3RlcikgewogICAgICAgIHJldHVybiBuZXdSdWJyaWMuYWRkQ2hpbGQoY2x1c3Rlcik7CiAgICAgIH0pOwogICAgICBuZXdSdWJyaWMudXNlU2NvcmVzID0gcnVicmljT2JqZWN0LnVzZVNjb3JlczsKICAgICAgcmV0dXJuIG5ld1J1YnJpYzsKICAgIH0KICB9XSk7CgogIHJldHVybiBSdWJyaWM7Cn0oQ29udGFpbmVyKTsKCmV4cG9ydCB7IFJ1YnJpYyBhcyBkZWZhdWx0IH07"},{"version":3,"sources":["D:\\Sites\\branch\\src\\Chamilo\\Libraries\\VuePlugins\\src\\Plugins\\ScoreRubric\\Domain\\Rubric.ts"],"names":[],"mappings":"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","sourcesContent":["import Cluster, {ClusterJsonObject} from \"@/Plugins/ScoreRubric/Domain/Cluster\";\nimport Level, {LevelId, LevelJsonObject} from \"@/Plugins/ScoreRubric/Domain/Level\";\nimport Choice, {ChoiceJsonObject} from \"@/Plugins/ScoreRubric/Domain/Choice\";\nimport Criterium, {CriteriumId} from \"@/Plugins/ScoreRubric/Domain/Criterium\";\nimport Container, {ContainerInterface} from \"@/Plugins/ScoreRubric/Domain/Container\";\n\nexport interface Element {\n    parent: Container | null;\n    title: string;\n\n    getScore(): number;\n}\n\nexport function isElement(object: any): object is Element {\n    return 'parent' in object && 'title' in object;\n}\n\n\nexport function isContainer(object: any): object is ContainerInterface {\n    return 'children' in object && isElement(object);\n}\n\nexport interface RubricChoiceJsonObject {\n    \"criteriumId\": string,\n    \"levelId\": string,\n    \"choice\": ChoiceJsonObject\n}\n\nexport interface RubricJsonObject {\n    useScores: boolean,\n    title: string,\n    levels: LevelJsonObject[],\n    clusters: ClusterJsonObject[],\n    choices: RubricChoiceJsonObject[]\n}\n\nexport default class Rubric extends Container {\n    public useScores: boolean = true;\n    public levels: Level[] = [];\n    public choices: Map<CriteriumId, Map<LevelId, Choice>> = new Map<CriteriumId, Map<LevelId, Choice>>();\n\n    get clusters():Cluster[] {\n        return this.children as Cluster[]; //invariant garded at addChild\n    }\n\n    addCluster(cluster: Cluster) {\n        this.addChild(cluster);\n    }\n\n    removeCluster(cluster: Cluster) {\n        this.removeChild(cluster);\n    }\n\n    protected addChild(element: Element): void {\n        super.addChild(element);\n        this.notifyAddChild(element);\n    }\n\n    protected notifyAddChild(element: Element): void {\n        if(element instanceof Criterium) {\n            this.onCriteriumAdded(element);\n        }\n\n        else if(element instanceof Container) {\n            let addedCriteria = this.getAllCriteria(element);\n            addedCriteria.forEach(criterium => {\n                this.levels.forEach(level =>\n                {\n                    let choice = this.findChoice(criterium, level);\n                    if(!choice)\n                        choice = new Choice(false, \"\");\n                    this.addChoice(choice, criterium.id, level.id);\n                })\n            });\n        }\n        //no more bubbling\n    }\n\n    protected onCriteriumAdded(criterium:Criterium) {\n        this.levels.forEach(level => {\n            //choice already exists for criterium? Could be through json bootstrapping.\n            let choice = this.findChoice(criterium, level);\n            if(!choice)\n                choice = new Choice(false, \"\");\n            this.addChoice(choice, criterium.id, level.id);\n        });\n    }\n\n    protected notifyRemoveChild(container: Container, element: Element): void {\n        let criteriaToBeRemoved = this.getAllCriteria(container);\n        criteriaToBeRemoved.forEach(criterium => this.removeChoicesByCriterium(criterium));\n    }\n\n    toJSON(): RubricJsonObject {\n        return {\n            useScores: this.useScores,\n            title: this.title,\n            levels: this.levels,\n            clusters: this._children.map(cluster => (cluster as Cluster).toJSON()),\n            choices: this.getChoicesJSON()\n        }\n    }\n\n    protected getChoicesJSON(): RubricChoiceJsonObject[]{\n        let choicesArray:RubricChoiceJsonObject[] = [];\n        this.choices.forEach((levelMap, criteriumId) => {\n            levelMap.forEach((choice, levelId) => {\n                choicesArray.push(\n                    {\n                        \"criteriumId\": criteriumId,\n                        \"levelId\": levelId,\n                        \"choice\": choice.toJSON()\n                    }\n                )\n            })\n        } );\n        return choicesArray;\n    }\n\n    static fromJSON(rubric:string|RubricJsonObject):Rubric {\n        let rubricObject: RubricJsonObject;\n        if(typeof rubric === 'string') {\n            rubricObject = JSON.parse(rubric);\n        } else {\n            rubricObject = rubric;\n        }\n\n        let newRubric = new Rubric(rubricObject.title);\n        newRubric.levels.push(...rubricObject.levels.map(level => Level.fromJSON(level)));\n\n        rubricObject.choices.forEach(rubricChoiceJsonObject => {\n            newRubric.addChoice(\n                Choice.fromJSON(rubricChoiceJsonObject.choice),\n                rubricChoiceJsonObject.criteriumId,\n                rubricChoiceJsonObject.levelId,\n                )\n        });\n\n        rubricObject.clusters\n            .map(clusterJsonObject => Cluster.fromJSON(clusterJsonObject))\n            .forEach(cluster => newRubric.addChild(cluster));\n\n        newRubric.useScores = rubricObject.useScores;\n\n        return newRubric;\n    }\n\n    protected addChoice(choice: Choice, criteriumId: CriteriumId, levelId: LevelId){\n        let criteriumChoices = this.choices.get(criteriumId);\n        if (criteriumChoices === undefined) {\n            criteriumChoices = new Map<LevelId, Choice>();\n            this.choices.set(criteriumId, criteriumChoices);\n        }\n        criteriumChoices.set(levelId, choice);\n    }\n\n    protected removeChoicesByCriterium(criterium: Criterium) {\n        this.choices.delete(criterium.id);\n    }\n\n    protected removeChoicesByLevel(level: Level) {\n        Array.from(this.choices.values()).forEach(levelChoices => levelChoices.delete(level.id))\n    }\n\n    protected findChoice(criterium: Criterium, level: Level):Choice|undefined {\n        let criteriumChoices = this.choices.get(criterium.id);\n        if (criteriumChoices === undefined) {\n            return undefined;\n        }\n\n        return criteriumChoices.get(level.id);\n    }\n\n    /**\n     * Invariant: to the outside world a choice is always available for a criterium and level of the rubric.\n     * @param criterium\n     * @param level\n     */\n    public getChoice(criterium: Criterium, level: Level):Choice {\n        let choice = this.findChoice(criterium, level);\n        if(!choice) {\n            throw new Error(`No choice found for criteria: ${criterium} and level: ${level}`);\n        }\n        return choice;\n    }\n\n    public addLevel(level: Level) {\n        this.levels.push(level);\n        this.getAllCriteria().forEach(criterium => {\n            this.addChoice(new Choice(false, \"\"), criterium.id, level.id)\n        })\n    }\n\n    public removeLevel(level: Level) {\n        const index = this.levels.indexOf(level);\n        this.levels.splice(index, 1);\n        this.removeChoicesByLevel(level);\n    }\n\n    public moveLevelDown(level: Level) {\n        this.moveItemInArray(\n            this.levels, this.levels.indexOf(level), this.levels.indexOf(level) + 1\n        )\n    }\n\n    public moveLevelUp(level: Level) {\n        this.moveItemInArray(\n            this.levels, this.levels.indexOf(level), this.levels.indexOf(level) - 1\n        )\n    }\n\n    protected moveItemInArray(array: any[], from: number, to: number) {\n        if (to >= array.length || from >= array.length)\n            return;\n        if (to < 0 || from < 0)\n            return;\n\n        array.splice(to, 0, array.splice(from, 1)[0]);\n    }\n\n    public getChoiceScore(criterium: Criterium, level: Level){\n        let choice = this.getChoice(criterium, level);\n        if(choice.hasFixedScore)\n            return choice.fixedScore;\n\n        return Math.round(criterium.weight * level.score) / 100;\n    }\n\n    public getScore() {\n        return this._children\n            .reduce((accumulator, currentContainer) => accumulator + currentContainer.getScore(), 0);\n    }\n\n    public getAllCriteria(container: Container = this) {\n        const criteria: Criterium[] = [];\n        this.getCriteriaRecursive(container, criteria);\n\n        return criteria;\n    }\n\n    protected getCriteriaRecursive(container: Container, criteria: Criterium[]) {\n        container.children.filter(child => (child instanceof Criterium)).forEach(\n            criterium => criteria.push(criterium as Criterium)\n        );\n\n        container.children.filter(child => isContainer(child)).forEach(\n            childContainer => this.getCriteriaRecursive(childContainer as Container, criteria)\n        )\n    }\n\n}\n"],"sourceRoot":""}]}