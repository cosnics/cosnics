$(function(){var b=0;var d="Chamilo\\Core\\Repository\\ContentObject\\AssessmentMultipleChoiceQuestion\\Ajax";var g=getPath("WEB_PATH")+"index.php";var k="Chamilo\\Core\\Repository\\ContentObject\\AssessmentMultipleChoiceQuestion";function i(){var n,m,l;l=$(".table.table-assessment-question-form > tbody > tr");if(l.size()<=2){$(".option-remove",l).addClass("text-muted");$(".option-remove",l).removeClass("text-danger")}else{$(".option-remove",l).removeClass("text-muted");$(".option-remove",l).addClass("text-danger")}}function j(p,q){p.preventDefault();var o=$("#mc_answer_type").val(),n,m,l=0;if(o==1){m=2;n=getTranslation("SwitchToRadioButtons",null,k)}else{m=1;n=getTranslation("SwitchToCheckboxes",null,k)}$(".option-value").each(function(){var r=$(this);var s=r.parent();if(m==1){s.removeClass("checkbox");s.addClass("radio");r.attr("name","correct");r.attr("value",l);r.attr("type","radio")}else{s.removeClass("radio");s.addClass("checkbox");r.attr("name","correct["+l+"]");r.attr("value",1);r.attr("type","checkbox")}l+=1});$("#mc_answer_type").val(m);setMemory("mc_answer_type",m);$(".change-answer-type").attr("title",n);$(".change-answer-type span:not(.inline-glyph)").text(n)}function e(p,q){p.preventDefault();var m=confirm(getTranslation("ConfirmOptionDelete",null,k));if(!m){return false}var r=$(this);var n=r.data("option-id");destroyHtmlEditor("value["+n+"]");destroyHtmlEditor("feedback["+n+"]");$('.table.table-assessment-question-form tr[data-option-id="'+n+'"]').remove();var o={application:d,go:"SkipOption","option-number":n};var l=$.ajax({type:"POST",url:g,data:o}).success(function(s){if(s.result_code==200){b+=1;i()}})}function h(z,u){z.preventDefault();var w=$("#mc_number_of_options").val(),p=(parseInt(w,10)+1),v=$("#mc_answer_type").val(),E,x,n,y,m,t,C,l,A,B,s,o;A={width:"100%",height:"65",collapse_toolbar:true};setMemory("mc_number_of_options",p);$("#mc_number_of_options").val(p);if(v==1){selectionName="correct";selectionValue=w;selectionType="radio"}else{selectionName="correct["+w+"]";selectionValue=1;selectionType="checkbox"}fieldSelection='<div class="'+selectionType+'">';fieldSelection+='<input class="option-value" type="'+selectionType+'" value="'+selectionValue+'" name="'+selectionName+'" data-option-id="'+w+'" />';fieldSelection+="<label></label>";fieldSelection+="</div>";y=renderHtmlEditor("value["+w+"]",A);var r=getTranslation("Feedback",null,k);var q=getTranslation("Score",null,k);var D=getTranslation("Delete",null,"Chamilo\\Libraries");fieldFeedback='<div class="option-feedback-field form-assessment-extra-container" data-element="feedback['+w+']">';fieldFeedback+="<label>"+r+"</label>";fieldFeedback+=renderHtmlEditor("feedback["+w+"]",A);fieldFeedback+="</div>";t='<div class="option-score-field form-assessment-extra-container form-inline" data-element="score['+w+']">';t+="<label>"+q+":</label> ";t+='<input size="2" class="input_numeric form-control" name="score['+w+']" value="0" type="text">';t+="</div>";fieldActions='<span title="'+r+'" data-option-id="'+w+'" class="option-action option-feedback fas fa-comment text-primary"></span>';fieldActions+="<br>";fieldActions+='<span title="'+q+'" data-option-id="'+w+'" class="option-action option-score fas fa-percent text-primary"></span>';fieldActions+="<br>";fieldActions+='<span title="'+D+'" data-option-id="'+w+'" class="option-action option-remove fas fa-trash-alt text-danger"></span>';tableRow='<tr data-option-id="'+w+'">';tableRow+='<td class="table-cell-selection cell-stat-x2">'+fieldSelection+"</td>";tableRow+="<td>"+y+fieldFeedback+t+"</td>";tableRow+='<td class="table-cell-action cell-stat-x2 text-right">'+fieldActions+"</td>";tableRow+="</tr>";$(".table.table-assessment-question-form > tbody").append(tableRow);i()}function c(m,n){var l=$(this).prop("checked");$('input[name="weight"]').prop("disabled",(l)?true:false)}function f(l,p){var m=l.data("option-id");var o=$('.table.table-assessment-question-form > tbody > tr[data-option-id="'+m+'"]');var n=$("div.option-"+p+"-field",o);if(n.is(":visible")){n.hide()}else{n.show()}}function a(){$("input.option-value").each(function(){var n=$(this);var p=n.data("option-id");var m=$('input[name="score['+p+']"]');var l=m.val();var o=n.is(":checked");if(o&&l<=0){m.val(1)}else{if(!o&&l>0){m.val(0)}}})}$(document).ready(function(){$(document).on("click",".change-answer-type",j);$(document).on("click",".add-option",h);$(document).on("click",'input[name="recalculate_weight"]',c);$(document).on("click","input.option-value",a);$(document).on("click",".table.table-assessment-question-form .option-remove.text-danger",e);$(document).on("click",".table.table-assessment-question-form .option-feedback",function(l,m){f($(this),"feedback")});$(document).on("click",".table.table-assessment-question-form .option-score",function(l,m){f($(this),"score")})})});