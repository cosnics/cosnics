$(function(){var b=0;var d="Chamilo\\Core\\Repository\\ContentObject\\AssessmentSelectQuestion\\Ajax";var g=getPath("WEB_PATH")+"index.php";var k="Chamilo\\Core\\Repository\\ContentObject\\AssessmentSelectQuestion";function i(){var n,m,l;l=$(".table.table-assessment-question-form > tbody > tr");if(l.size()<=2){$(".option-remove",l).addClass("text-muted");$(".option-remove",l).removeClass("text-danger")}else{$(".option-remove",l).removeClass("text-muted");$(".option-remove",l).addClass("text-danger")}}function j(p,q){p.preventDefault();var o=$("#select_answer_type").val(),n,m,l=0;if(o=="radio"){m="checkbox";n=getTranslation("SwitchToMultipleSelect",null,k)}else{m="radio";n=getTranslation("SwitchToSingleSelect",null,k)}$(".option-value").each(function(){var r=$(this);var s=r.parent();if(m=="radio"){s.removeClass("checkbox");s.addClass("radio");r.attr("name","correct");r.attr("value",l);r.attr("type","radio")}else{s.removeClass("radio");s.addClass("checkbox");r.attr("name","correct["+l+"]");r.attr("value",1);r.attr("type","checkbox")}l+=1});$("#select_answer_type").val(m);setMemory("select_answer_type",m);$(".change-answer-type").attr("title",n);$(".change-answer-type span:not(.inline-glyph)").text(n)}function e(p,q){p.preventDefault();var m=confirm(getTranslation("ConfirmOptionDelete",null,k));if(!m){return false}var r=$(this);var n=r.data("option-id");destroyHtmlEditor("feedback["+n+"]");$('.table.table-assessment-question-form tr[data-option-id="'+n+'"]').remove();var o={application:d,go:"SkipOption","option-number":n};var l=$.ajax({type:"POST",url:g,data:o}).success(function(s){if(s.result_code==200){b+=1;i()}})}function h(w,v){w.preventDefault();var r=$("#select_number_of_options").val(),n=(parseInt(r,10)+1),B=$("#select_answer_type").val(),l,x,u,A,m,q,z,p,t,o,y,s;t={width:"100%",height:"65",collapse_toolbar:true};setMemory("select_number_of_options",n);$("#select_number_of_options").val(n);if(B=="radio"){selectionName="correct";selectionValue=r;selectionType="radio"}else{selectionName="correct["+r+"]";selectionValue=1;selectionType="checkbox"}fieldSelection='<div class="'+selectionType+'">';fieldSelection+='<input class="option-value" type="'+selectionType+'" value="'+selectionValue+'" name="'+selectionName+'" data-option-id="'+r+'" />';fieldSelection+="<label></label>";fieldSelection+="</div>";A='<input class="form-control" name="value['+r+']" type="text">';fieldFeedback='<div class="option-feedback-field form-assessment-extra-container" data-element="feedback['+r+']">';fieldFeedback+="<label>"+getTranslation("Feedback",null,k)+"</label>";fieldFeedback+=renderHtmlEditor("feedback["+r+"]",t);fieldFeedback+="</div>";q='<div class="option-score-field form-assessment-extra-container form-inline" data-element="score['+r+']">';q+="<label>"+getTranslation("Score",null,k)+":</label> ";q+='<input size="2" class="input_numeric form-control" name="score['+r+']" value="0" type="text">';q+="</div>";fieldActions='<span data-option-id="'+r+'" class="option-action option-feedback fas fa-comment text-primary"></span>';fieldActions+="<br>";fieldActions+='<span data-option-id="'+r+'" class="option-action option-score fas fa-percent text-primary"></span>';fieldActions+="<br>";fieldActions+='<span data-option-id="'+r+'" class="option-action option-remove fas fa-trash-alt text-danger"></span>';tableRow='<tr data-option-id="'+r+'">';tableRow+='<td class="table-cell-selection cell-stat-x2">'+fieldSelection+"</td>";tableRow+="<td>"+A+fieldFeedback+q+"</td>";tableRow+='<td class="table-cell-action cell-stat-x2 text-right">'+fieldActions+"</td>";tableRow+="</tr>";$(".table.table-assessment-question-form > tbody").append(tableRow);i()}function c(m,n){var l=$(this).prop("checked");$('input[name="weight"]').prop("disabled",(l)?true:false)}function f(l,p){var m=l.data("option-id");var o=$('.table.table-assessment-question-form > tbody > tr[data-option-id="'+m+'"]');var n=$("div.option-"+p+"-field",o);if(n.is(":visible")){n.hide()}else{n.show()}}function a(){$("input.option-value").each(function(){var n=$(this);var p=n.data("option-id");var m=$('input[name="score['+p+']"]');var l=m.val();var o=n.is(":checked");if(o&&l<=0){m.val(1)}else{if(!o&&l>0){m.val(0)}}})}$(document).ready(function(){$(document).on("click",".change-answer-type",j);$(document).on("click",".add-option",h);$(document).on("click",'input[name="recalculate_weight"]',c);$(document).on("click","input.option-value",a);$(document).on("click",".table.table-assessment-question-form .option-remove.text-danger",e);$(document).on("click",".table.table-assessment-question-form .option-feedback",function(l,m){f($(this),"feedback")});$(document).on("click",".table.table-assessment-question-form .option-score",function(l,m){f($(this),"score")})})});